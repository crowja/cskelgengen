SHELL = /bin/bash

.POSIX:
.SUFFIXES:
.SUFFIXES:

SRC_DIR      = ./src
BUILD_DIR    = ./build

CC           = gcc
CFLAGS       = -I$(SRC_DIR) -std=c99 -pedantic -Wall

MKDIR        = mkdir -p

.PHONY: clean dirs

all: dirs $(BUILD_DIR)/rf

dirs:
	@$(MKDIR) $(BUILD_DIR)

$(BUILD_DIR)/rf: $(BUILD_DIR)/main.o $(BUILD_DIR)/options.o $(BUILD_DIR)/fgetopt.o
	$(CC) $(LDFLAGS) -o $(BUILD_DIR)/rf \
		$(BUILD_DIR)/main.o $(BUILD_DIR)/options.o $(BUILD_DIR)/fgetopt.o

$(BUILD_DIR)/main.o: $(SRC_DIR)/main.c $(SRC_DIR)/main.h
	$(CC) -c $(CFLAGS) -o $(BUILD_DIR)/main.o $(SRC_DIR)/main.c

$(BUILD_DIR)/options.o: $(SRC_DIR)/options.c $(SRC_DIR)/options.h
	$(CC) -c $(CFLAGS) -o $(BUILD_DIR)/options.o $(SRC_DIR)/options.c

$(BUILD_DIR)/fgetopt.o: $(SRC_DIR)/fgetopt.c $(SRC_DIR)/fgetopt.h
	$(CC) -c $(CFLAGS) -o $(BUILD_DIR)/fgetopt.o $(SRC_DIR)/fgetopt.c


# Example of how to template for variables set by configure
howdy:

clean:
	$(RM) $(BUILD_DIR)/rf $(BUILD_DIR)/*.o

# SQLITE3_CFLAGS    is @SQLITE3_CFLAGS@
# SQLITE3_LDFLAGS   is @SQLITE3_LDFLAGS@
# PACKAGE_NAME      is @PACKAGE_NAME@
# PACKAGE_TARNAME   is @PACKAGE_TARNAME@
# PACKAGE_VERSION   is @PACKAGE_VERSION@
# PACKAGE_STRING    is @PACKAGE_STRING@
# PACKAGE_BUGREPORT is @PACKAGE_BUGREPORT@
# PACKAGE_URL       is @PACKAGE_URL@
#
# builddir          is @builddir@
# abs_builddir      is @abs_builddir@
# top_builddir      is @top_builddir@
# abs_top_builddir  is @abs_top_builddir@
# 
# srcdir            is @srcdir@
# abs_srcdir        is @abs_srcdir@
# top_srcdir        is @top_srcdir@
# abs_top_srcdir    is @abs_top_srcdir@
#
# CFLAGS            is @CFLAGS@
# DEFS              is @DEFS@
# LDFLAGS           is @LDFLAGS@
# LIBS              is @LIBS@
#
# prefix            is @prefix@
# exec_prefix       is @exec_prefix@
#
#                      @OPENMP_CFLAGS@"

distclean:
	$(MAKE) clean
	$(RM) -r autom4te.cache  config.status config.log

